# 统计系统使用说明

## 🚀 快速开始

### 1. 启动服务

```bash
# 安装依赖
go mod tidy

# 配置环境变量
export MYSQL_DSN="root:password@tcp(localhost:3306)/stat?charset=utf8mb4&parseTime=True&loc=Local"
export CLICKHOUSE_DSN="clickhouse://default:@localhost:9000/stat?dial_timeout=10s&read_timeout=20s"

# 初始化数据库
mysql -u root -p < init.sql

# 启动服务
go run cmd/main.go
```

### 2. 访问系统

- **登录页面**: http://localhost:8080/login
- **管理后台**: http://localhost:8080/admin/dashboard
- **默认账号**: admin / admin123

## 🎯 主要功能

### 用户认证
- ✅ 用户注册（邮箱验证码）
- ✅ 用户登录（用户名/邮箱）
- ✅ 密码重置
- ✅ 记住登录状态
- ✅ Token认证

### 站点管理
- ✅ 创建统计站点
- ✅ 生成统计脚本
- ✅ 查看站点列表
- ✅ 删除站点

### 数据统计
- ✅ 实时PV/UV统计
- ✅ 趋势图表
- ✅ 热门页面分析
- ✅ 实时访问记录

### 事件埋点
- ✅ 自定义事件上报
- ✅ 事件数据分析
- ✅ 用户行为追踪

## 🎨 现代化特性

### 界面设计
- 🎨 **Tailwind CSS** - 现代化UI框架
- 📱 **响应式设计** - 支持移动端
- 🎭 **渐变背景** - 美观的视觉效果
- ✨ **交互动画** - 流畅的用户体验

### 用户体验
- 🔔 **通知系统** - 实时反馈
- 🔄 **加载状态** - 清晰的进度提示
- 🎯 **表单验证** - 友好的错误提示
- 💾 **本地存储** - 记住用户偏好

### 技术架构
- 🏗️ **模板渲染** - 服务端渲染
- 🔒 **权限控制** - 路由级认证
- 📊 **实时数据** - 自动刷新
- 🎨 **组件化** - 可复用的UI组件

## 📱 页面结构

```
/admin/dashboard    - 仪表盘（数据概览）
/admin/sites        - 站点管理
/admin/reports      - 数据报表
/admin/events       - 事件分析
/admin/settings     - 系统设置
```

## 🔧 技术栈

### 前端
- **HTML5** - 语义化标记
- **Tailwind CSS** - 实用优先的CSS框架
- **Font Awesome** - 图标库
- **Chart.js** - 图表库
- **原生JavaScript** - 无框架依赖

### 后端
- **Go** - 高性能语言
- **Gin** - Web框架
- **GORM** - ORM框架
- **MySQL** - 关系型数据库
- **ClickHouse** - 列式数据库

## 🎯 使用流程

### 1. 用户注册/登录
1. 访问登录页面
2. 使用演示账号或注册新账号
3. 登录成功后自动跳转到仪表盘

### 2. 创建统计站点
1. 进入"站点管理"页面
2. 点击"新建站点"
3. 填写站点信息
4. 获取统计脚本

### 3. 集成统计脚本
1. 复制生成的脚本代码
2. 添加到网站页面中
3. 开始自动统计

### 4. 查看统计数据
1. 在仪表盘查看实时数据
2. 在数据报表查看趋势
3. 在事件分析查看用户行为

## 🔒 安全特性

- **Token认证** - JWT风格的认证机制
- **密码加密** - MD5加密存储
- **会话管理** - 自动过期机制
- **权限控制** - 路由级访问控制
- **输入验证** - 服务端数据验证

## 📊 数据统计

### 自动采集
- 页面访问（PV）
- 独立访客（UV）
- 停留时长
- 设备信息
- 地理位置
- 来源页面

### 手动上报
- 自定义事件
- 用户行为
- 业务数据
- 转化目标

## 🎨 界面预览

### 登录页面
- 渐变背景设计
- 卡片式布局
- 演示账号提示
- 注册功能集成

### 管理后台
- 侧边栏导航
- 响应式布局
- 数据可视化
- 实时通知

### 站点管理
- 表格展示
- 模态框操作
- 脚本生成
- 一键复制

## 🚀 部署建议

### 开发环境
```bash
go run cmd/main.go
```

### 生产环境
```bash
# 编译
go build -o stat cmd/main.go

# 运行
./stat
```

### Docker部署
```bash
docker build -t stat-system .
docker run -p 8080:8080 stat-system
```

## 📝 注意事项

1. **数据库配置** - 确保MySQL和ClickHouse正常运行
2. **环境变量** - 正确配置数据库连接字符串
3. **端口占用** - 默认使用8080端口
4. **文件权限** - 确保模板文件可读
5. **网络访问** - 确保API接口可访问

## 🔧 故障排除

### 常见问题
1. **数据库连接失败** - 检查DSN配置
2. **模板加载失败** - 检查templates目录
3. **静态文件404** - 检查static目录
4. **认证失败** - 检查token有效性

### 调试方法
1. 查看控制台日志
2. 检查网络请求
3. 验证数据库连接
4. 测试API接口

## 📞 技术支持

如有问题，请：
1. 查看控制台错误信息
2. 检查网络连接状态
3. 验证数据库配置
4. 提交Issue反馈 